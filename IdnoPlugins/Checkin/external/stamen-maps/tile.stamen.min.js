(function(b){var d="a. b. c. d.".split(" "),h=function(j,k,l,i){return{url:["https://stamen-tiles-{S}a.ssl.fastly.net/",j,"/{Z}/{X}/{Y}.",k].join(""),type:k,subdomains:d.slice(),minZoom:l,maxZoom:i,attribution:['Map tiles by <a href="http://stamen.com">Stamen Design</a>, ','under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. ','Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, ','under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.'].join("")}},f={toner:h("toner","png",0,20),terrain:h("terrain","jpg",4,18),watercolor:h("watercolor","jpg",1,16),"trees-cabs-crime":{url:"https://stamen-tiles-{S}.a.ssl.fastly.net/v3/stamen.trees-cabs-crime/{Z}/{X}/{Y}.png",type:"png",subdomains:"a b c d".split(" "),minZoom:11,maxZoom:18,extent:[{lat:37.853,lon:-122.577},{lat:37.684,lon:-122.313}],attribution:['Design by Shawn Allen at <a href="http://stamen.com">Stamen</a>.','Data courtesy of <a href="http://fuf.net">FuF</a>,','<a href="http://www.yellowcabsf.com">Yellow Cab</a>','&amp; <a href="http://sf-police.org">SFPD</a>.'].join(" ")}};a("toner",["hybrid","labels","lines","background","lite"]);a("toner",["2010"]);a("toner",["2011","2011-lines","2011-labels","2011-lite"]);a("terrain",["background"]);a("terrain",["labels","lines"],"png");b.stamen=b.stamen||{};b.stamen.tile=b.stamen.tile||{};b.stamen.tile.providers=f;b.stamen.tile.getProvider=e;function a(n,j,m){var o=e(n);for(var l=0;l<j.length;l++){var k=[n,j[l]].join("-");f[k]=h(k,m||o.type,o.minZoom,o.maxZoom)}}function e(i){if(i in f){return f[i]}else{throw"No such provider ("+i+")"}}if(typeof MM==="object"){var g=(typeof MM.Template==="function")?MM.Template:MM.TemplatedMapProvider;MM.StamenTileLayer=function(i){var j=e(i);this._provider=j;MM.Layer.call(this,new g(j.url,j.subdomains));this.provider.setZoomRange(j.minZoom,j.maxZoom);this.attribution=j.attribution};MM.StamenTileLayer.prototype={setCoordLimits:function(i){var j=this._provider;if(j.extent){i.coordLimits=[i.locationCoordinate(j.extent[0]).zoomTo(j.minZoom),i.locationCoordinate(j.extent[1]).zoomTo(j.maxZoom)];return true}else{return false}}};MM.extend(MM.StamenTileLayer,MM.Layer)}if(typeof L==="object"){L.StamenTileLayer=L.TileLayer.extend({initialize:function(j){var k=e(j),i=k.url.replace(/({[A-Z]})/g,function(l){return l.toLowerCase()});L.TileLayer.prototype.initialize.call(this,i,{minZoom:k.minZoom,maxZoom:k.maxZoom,subdomains:k.subdomains,scheme:"xyz",attribution:k.attribution})}})}if(typeof OpenLayers==="object"){function c(i){return i.replace(/({.})/g,function(j){return"$"+j.toLowerCase()})}OpenLayers.Layer.Stamen=OpenLayers.Class(OpenLayers.Layer.OSM,{initialize:function(n,m){var p=e(n),l=p.url,j=p.subdomains,k=[];if(l.indexOf("{S}")>-1){for(var o=0;o<j.length;o++){k.push(c(l.replace("{S}",j[o])))}}else{k.push(c(l))}m=OpenLayers.Util.extend({numZoomLevels:p.maxZoom,buffer:0,transitionEffect:"resize",tileOptions:{crossOriginKeyword:null}},m);return OpenLayers.Layer.OSM.prototype.initialize.call(this,n,k,m)}})}if(typeof google==="object"&&typeof google.maps==="object"){google.maps.StamenMapType=function(j){var k=e(j),i=k.subdomains;return google.maps.ImageMapType.call(this,{getTileUrl:function(r,o){var n=1<<o,p=r.x%n,l=(p<0)?p+n:p,q=r.y,m=(o+l+q)%i.length;return k.url.replace("{S}",i[m]).replace("{Z}",o).replace("{X}",l).replace("{Y}",q)},tileSize:new google.maps.Size(256,256),name:j,minZoom:k.minZoom,maxZoom:k.maxZoom})};google.maps.StamenMapType.prototype=new google.maps.ImageMapType("_")}})(typeof exports==="undefined"?this:exports);